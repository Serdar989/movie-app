(()=>{"use strict";const e="https://image.tmdb.org/t/p/w500/",t=function(e){return`https://api.themoviedb.org/3${e}?api_key=90e6cdedb1af5c0bd8f14b69484e25e1`},n=async function(e){try{const n=await Promise.race([fetch(e),(t=10,new Promise((function(e,n){setTimeout((function(){n(new Error(`Request took too long! Timeout after ${t} second`))}),1e3*t)})))]);return await n.json()}catch(e){throw e}var t},a={movie:{},movieTopRated:{},search:{query:"",results:[],page:1,resultsPerPage:5},slides_per_page:6,lists:[],slide_index:1,topRated:[],topRated_slide_index:1,bookmarks:[],bookmarksID:[],rate:""},r=function(e=a.search.page){a.search.page=e;const t=(e-1)*a.search.resultsPerPage,n=e*a.search.resultsPerPage;return a.search.results.slice(t,n)},i=async function(e,r){try{const i=t(`/movie/${e}/videos`),s=await n(i),o=r.find((t=>t.id==e));a.movieTopRated=function(e,t){const n=e.results[0];return{id:t.id,title:t.title,language:t.language,releaseDate:t.releaseDate,posterPath:t.posterPath,overview:t.overview,popularity:t.popularity,voteAverage:t.voteAverage,key:null!=n?n.key:"",bookmarked:t.bookmarked,myRate:t.myRate?t.myRate:"N/A"}}(s,o);const l=a.bookmarksID.findIndex((t=>t==e));-1!=l&&null!=a.bookmarks[l].myRate?a.movieTopRated.myRate=a.bookmarks[l].myRate:a.movieTopRated.myRate=""}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥`),e}},s=async function(){try{const e=t("/movie/now_playing");return function(e){a.lists=e.results.map((e=>({id:e.id,title:e.title,language:e.original_language,releaseDate:e.release_date,posterPath:e.poster_path,overview:e.overview,popularity:e.popularity,voteAverage:e.vote_average,bookmarked:""})))}(await n(e)),a.lists}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥`),e}},o=async function(){try{const e=t("/movie/top_rated");!function(e){a.topRated=e.results.map((e=>({id:e.id,title:e.title,language:e.original_language,releaseDate:e.release_date,posterPath:e.poster_path,overview:e.overview,popularity:e.popularity,voteAverage:e.vote_average,bookmarked:""})))}(await n(e));return a.topRated}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥`),e}},l=function(){localStorage.setItem("bookmarks",JSON.stringify(a.bookmarks)),localStorage.setItem("bookmarksID",JSON.stringify(a.bookmarksID))};!function(){const e=localStorage.getItem("bookmarks"),t=localStorage.getItem("bookmarksID");e&&(a.bookmarks=JSON.parse(e),a.bookmarksID=JSON.parse(t))}();const d=function(){localStorage.clear("bookmarks"),localStorage.clear("bookmarksID")};const c=new class{addHandlerQuery(e){const t=[window.matchMedia("(min-width: 1200px)"),window.matchMedia("(min-width: 981px) and (max-width: 1200px)"),window.matchMedia("(min-width: 769px) and (max-width: 980px)"),window.matchMedia("(min-width: 541px) and (max-width: 768px)"),window.matchMedia("(min-width: 501px) and (max-width: 540px)"),window.matchMedia("(min-width: 320px) and (max-width: 500px)")];for(let n=0;n<t.length;n++)t[n].addEventListener("change",function(){this.controlQuery(t),e()}.bind(this),!1);this.controlQuery(t)}controlQuery(e){e[0].matches&&(a.slides_per_page=6,a.search.resultsPerPage=5),e[1].matches&&(a.slides_per_page=5,a.search.resultsPerPage=4),e[2].matches&&(a.slides_per_page=4,a.search.resultsPerPage=3),e[3].matches&&(a.slides_per_page=3,a.search.resultsPerPage=2),e[4].matches&&(a.slides_per_page=2,a.search.resultsPerPage=2),e[5].matches&&(a.slides_per_page=1,a.search.resultsPerPage=1)}};const p=new class{constructor(){this.singleMovie=document.querySelector("#movie"),this.parentElement=document.querySelector(".results"),this.parentElementMovie=document.querySelector(".details-box"),this.popupRating=document.querySelector(".popUp-rating"),this.ratingForm=document.getElementById("ratingForm"),this.checkBox=document.querySelectorAll(".rateCheckbox"),this.checkBtn=document.querySelector(".checkBtn"),this.voteContainer=document.querySelector(".vote-container")}addHandlerRender(e){const t=this.singleMovie;this.parentElement.addEventListener("click",(function(n){const a=n.target.closest(".btn");if(!a)return;const r=a.dataset.movieId;t.scrollIntoView({behavior:"smooth",block:"start"}),e(r)}))}addHandlerPopup(){const e=this.popupRating;this.parentElementMovie.addEventListener("click",(function(t){t.target.closest(".rate-icon")&&e.classList.add("visible-rating")})),this.popupRating.addEventListener("click",(function(t){t.target.closest(".close-form")&&e.classList.remove("visible-rating")}))}addHandlerRate(e){let t=this.checkBox;const n=this.parentElementMovie;this.ratingForm.addEventListener("submit",(function(a){a.preventDefault();let r=null;document.querySelector(".rate").innerHTML="";for(let a=0;a<t.length;a++){if(t[a].checked){r=t[a].value;const i=n.firstElementChild.dataset.videoId;console.log(r,i),e(i,r)}t[a].checked=!1}}))}renderSpinner(){this.clear(),this.parentElementMovie.insertAdjacentHTML("afterbegin",'\n       <div class="spinner">\n         <i class="fas fa-spinner fa-spin"></i>\n        </div> \n  ')}render(e,t){this.clear();const n=this.generateMarkup(e,t);document.getElementById("movie").classList.add("movie-describe"),this.parentElementMovie.insertAdjacentHTML("afterbegin",n)}clear(){this.parentElementMovie.innerHTML=""}generateMarkup(t,n){return`<div class="movie-details" data-video-id = "${t.id}">\n              <div class="title-container">\n                 <h3><span>Movie title:</span> ${t.title}</h3>\n                  <div class="subtitle-description">\n                    <p><span>Language:</span>  ${t.language}</p>\n                    <p><span>Release date:</span>${t.releaseDate}</p>\n                  </div>\n                  \n              </div>\n              <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n              </div>\n              <div class="video-contianer">\n                ${""==t.key?'<div class="error">\n                        <div>\n                          <i class="fas fa-exclamation-triangle"></i>\n                        </div>\n                        <p>This movie doesn\'t have video</p>\n                       </div>':` <iframe\n                      src='https://www.youtube.com/embed/${t.key}'\n                  allowfullscreen=''\n                ></iframe>`}\n              </div>\n              <div class="video-description">\n              \n                <div class="overview-container">\n                   <p><span>Movie overview:</span> ${t.overview}</p>\n                 </div>\n                 <div class="popularity-container">\n                   <p><span>Movie popularity:</span> ${t.popularity}</p>\n                 </div>\n                 <div class="vote-container">\n                   <p><i class="fas fa-vote-yea"></i><span>Vote average:</span> ${t.voteAverage}</p>\n                  <p><i class="fas fa-vote-yea rate-icon"></i><span class= "my-rate">Your rate:</span><span class="rate">${null!=t.myRate?t.myRate:""} </span></p>                   \n                 </div>\n                 <div class="btn-container">\n                    <a href="#" class="btn details movie btn--bookmark" data-movie-id="${t.id}"\n                      > ${n.some((function(e){return e===t.id}))?"Remove bookmark":"Add to bookmark"}</a\n                    >\n                  </div>    \n               </div>\n\n             </div>\n           </div>`}};const m=new class{constructor(e){this.parentEl=document.querySelector(".search"),this.searchResult=document.querySelector(".search-results"),this.parentElement=document.querySelector(".results"),this.errorMessage=document.getElementById("message-error"),this.data=e,this.parentElementMovie=document.querySelector(".details-box"),this.pagination=document.querySelector(".pagination")}addHandlerSearch(e){this.parentEl.addEventListener("submit",(function(t){t.preventDefault(),e()}))}getQuery(){const e=this.parentEl.querySelector(".search__field").value;return this.clearInput(),e}clearInput(){this.parentEl.querySelector(".search__field").value=""}renderSpinner(){this.clear(),this.clearPagination(),this.parentElement.insertAdjacentHTML("afterbegin",'\n       <div class="spinner">\n         <i class="fas fa-spinner fa-spin"></i>\n        </div> \n  ')}render(e){if(!e||Array.isArray(e)&&0===e.length)return this.renderError();this.data=e,document.getElementById("movie").classList.remove("movie-describe"),this.parentElementMovie.innerHTML="";const t=this.generateMarkup();this.clear(),this.clearMessage(),this.parentElement.insertAdjacentHTML("beforeend",t)}clear(){this.parentElement.innerHTML=""}clearLoader(){this.searchResult.innerHTML=""}clearPagination(){this.pagination.innerHTML=""}generateMarkup(){return this.data.map((t=>{if(t.posterPath)return`<li class="single-movie">\n          <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n          </div>\n          <div class="movie-details">\n            <div class="title-container">\n              <h3>Title: ${t.title}</h3>\n            </div>\n            <div class="release-date">\n              <p>Vote average: ${t.voteAverage}</p>\n            </div>            \n            <div class="btn-container"><a href="#${t.id}" class="btn details"  data-movie-id="${t.id}">More details</a></div>\n          </div>\n        </li> `})).join("")}clearMessage(){this.errorMessage.innerHTML=""}renderError(){this.clearMessage(),this.clear(),this.errorMessage.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>NO MOVIES FOUND FOR YOUR QUERY! PLEASE TRY AGAIN</p>\n      </div>')}renderMessage(){this.clearMessage(),this.clear(),this.errorMessage.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is a field that the user must fill in</p>\n      </div>')}};const v=new class{constructor(){this.singleMovie=document.querySelector("#movie"),this.parentElement=document.querySelector(".latest-movie__list"),this.sliderNav=document.querySelector(".slider-nav"),this.sliderNext=document.querySelector(".slider-nav.next"),this.sliderPrevious=document.querySelector(".slider-nav.prev"),this.parentElementMovie=document.querySelector(".details-box")}listsRender(e){window.addEventListener("load",e)}renderSpinner(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n       <div class="spinner">\n         <i class="fas fa-spinner fa-spin"></i>\n        </div> \n  ')}render(e,t,n){if(this.clear(),!e||Array.isArray(e)&&0===e.length)return this.renderError();let a=[],r=t-1;for(let t=r;t<n+r&&t<e.length;t++){let n=this.generateMarkup(e[t]);a.push(n)}const i=a.join("");this.parentElement.insertAdjacentHTML("beforeend",i)}clear(){this.parentElement.innerHTML=""}addHandlerSlider(e){this.sliderNext.addEventListener("click",(function(t){t.target.closest(".fa-arrow-circle-right")&&e(1)})),this.sliderPrevious.addEventListener("click",(function(t){t.target.closest(".fa-arrow-circle-left")&&e(-1)}))}addHandlerSingleMovie(e){const t=this.singleMovie;this.parentElement.addEventListener("click",(function(n){const a=n.target.closest(".btn");if(!a)return;const r=a.dataset.movieId;t.scrollIntoView({behavior:"smooth",block:"start"}),e(r)}))}generateMarkup(t){return`<li class="single-movie slider-list">\n          <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n          </div>\n          <div class="movie-details">\n            <div class="title-container">\n              <h3>Title: ${t.title}</h3>\n            </div>\n            <div class="release-date">\n              <p>Vote average: ${t.voteAverage}</p>\n            </div>            \n            <div class="btn-container"><a href="#${t.id}" class="btn details"  data-movie-id="${t.id}">More details</a></div>\n          </div>\n        </li> `}renderError(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is some error. please try again</p>\n      </div>')}};const u=new class{constructor(){this.singleMovie=document.querySelector("#movie"),this.parentElement=document.querySelector(".top-rated-movies__list"),this.sliderNav=document.querySelector(".slider-nav"),this.sliderNext=document.querySelector(".top-rated-nav.next"),this.sliderPrevious=document.querySelector(".top-rated-nav.prev"),this.parentElementMovie=document.querySelector(".details-box"),this.parentElementBookmarks=document.querySelector(".bookmarks__list")}listsRender(e){window.addEventListener("load",e)}renderSpinner(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n       <div class="spinner">\n         <i class="fas fa-spinner fa-spin"></i>\n        </div> \n  ')}render(e,t,n){if(this.clear(),!e||Array.isArray(e)&&0===e.length)return this.renderError();let a=[],r=t-1;for(let t=r;t<n+r&&t<e.length;t++){let n=this.generateMarkup(e[t]);a.push(n)}const i=a.join("");this.parentElement.insertAdjacentHTML("beforeend",i)}clear(){this.parentElement.innerHTML=""}addHandlerSlider(e){this.sliderNext.addEventListener("click",(function(t){t.target.closest(".fa-arrow-circle-right")&&e(1)})),this.sliderPrevious.addEventListener("click",(function(t){t.target.closest(".fa-arrow-circle-left")&&e(-1)}))}addHandlerSingleMovie(e){const t=this.singleMovie;this.parentElement.addEventListener("click",(function(n){const a=n.target.closest(".btn");if(!a)return;const r=a.dataset.movieId;t.scrollIntoView({behavior:"smooth",block:"start"}),e(r)}))}generateMarkup(t){return`<li class="single-movie slider-list">\n          <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n          </div>\n          <div class="movie-details">\n            <div class="title-container">\n              <h3>Title: ${t.title}</h3>\n            </div>\n            <div class="release-date">\n              <p>Vote average: ${t.voteAverage}</p>\n            </div>            \n            <div class="btn-container"><a href="#${t.id}" class="btn details"  data-movie-id="${t.id}">More details</a></div>\n          </div>\n        </li> `}renderError(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is some error. please try again</p>\n      </div>')}};const h=new class{constructor(){this.parentElement=document.querySelector(".pagination")}addHandlerClick(e){this.parentElement.addEventListener("click",(function(t){const n=t.target.closest(".btn--inline");if(!n)return;const a=+n.dataset.goto;e(a)}))}render(e){if(this.clear(),!e||Array.isArray(e)&&0===e.length)return this.renderError();const t=this.generateMarkup(e);this.parentElement.insertAdjacentHTML("beforeend",t)}generateMarkup(e){const t=e.page,n=Math.ceil(e.results.length/e.resultsPerPage);return 1===t&&n>1?`\n      \n        <button data-goto="${t+1}" class="btn--inline pagination__btn--next">\n            <span>Page ${t+1}</span>\n                      <i class="fas fa-angle-right"></i>      \n\n          </button> \n      `:t===n&&n>1?`<button data-goto="${t-1}" class="btn--inline pagination__btn--prev">\n                       <i class="fas fa-angle-left"></i> \n\n            <span>Page ${t-1}</span>\n          </button>\n        `:t<n?`<button data-goto="${t-1}" class="btn--inline pagination__btn--prev">\n            <i class="fas fa-angle-left"></i> \n            <span>Page ${t-1}</span>\n          </button>\n          <button data-goto="${t+1}" class="btn--inline pagination__btn--next">\n            <span>Page ${t+1}</span>\n           <i class="fas fa-angle-right"></i>      \n          </button> \n        `:""}renderError(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is some error. please try again</p>\n      </div>')}clear(){this.parentElement.innerHTML=""}};const g=new class{constructor(){this.nav=document.querySelector(".nav"),this.bookmarks=document.querySelector(".bookmarks"),this.parentElement=document.querySelector(".bookmarks__list"),this.parentElementMovie=document.querySelector(".details-box"),this.bookmarksBtn=document.querySelector(".nav__btn--bookmarks")}addHandlerBookmarksLoad(e){window.addEventListener("load",e)}addHandlerBookmarkSingl(e){this.parentElement.addEventListener("click",(function(t){const n=t.target.closest(".single-movie");if(!n)return;const a=n.dataset.movieId;e(a)}))}addHandlerBookmarks(e){this.parentElementMovie.addEventListener("click",(function(t){const n=t.target.closest(".btn");if(!n)return;const a=n.dataset.movieId;e(a)}))}render(e){if(this.clear(),!e||Array.isArray(e)&&0===e.length)return this.renderError();const t=this.generateMarkup(e);this.parentElement.insertAdjacentHTML("afterbegin",t)}clear(){this.parentElement.innerHTML=""}generateMarkup(t){return t.map((t=>`<li class="single-movie slider-list" data-movie-id="${t.id}">\n          <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n          </div>\n          <div class="movie-details">\n            <div class="title-container">\n              <h2>Title: ${t.title}</h2>\n            </div>\n            <div class="release-date">\n              <p>Vote average: ${t.voteAverage}</p>\n            </div>            \n          \n          </div>\n        </li> `)).join("")}renderError(){this.parentElement.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is some error. please try again</p>\n      </div>')}toggleBookmarks(){const e=this.bookmarks;this.nav.addEventListener("click",(function(t){const n=t.target.closest(".nav__btn--bookmarks");n&&(e.classList.toggle("show-bookmarks"),n.classList.toggle("show-bookmarks"))}))}hideBookmarks(){const e=this.bookmarks,t=this.bookmarksBtn;e.classList.remove("show-bookmarks"),t.classList.remove("show-bookmarks")}},k=async function(){try{const e=m.getQuery();if(!e)return;m.renderSpinner(),await async function(e){try{a.search.query=e;const r=t("/search/movie")+"&query="+e,i=(await n(r)).results;a.search.results=i.map((e=>({id:e.id,title:e.title,language:e.original_language,releaseDate:e.release_date,posterPath:e.poster_path,overview:e.overview,popularity:e.popularity,voteAverage:e.vote_average,bookmarked:"",myRate:""}))),a.search.page=1}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥`),e}}(e),m.render(r()),h.render(a.search)}catch(e){console.log(e)}},f=function(e){m.render(r(e)),h.render(a.search)},b=async function(e){try{p.renderSpinner(),await i(e,a.search.results),p.render(a.movieTopRated,a.bookmarksID)}catch(e){console.log(e)}},y=async function(){try{v.renderSpinner();const e=await s();v.render(e,a.slide_index,a.slides_per_page)}catch(e){console.log(e)}},_=function(e){v.render(a.lists,a.slide_index,a.slides_per_page)},M=function(e){let t=a.lists.length;a.slide_index+=e,a.slide_index===t+1?a.slide_index=1:0===a.slide_index&&(a.slide_index=t),v.render(a.lists,a.slide_index,a.slides_per_page)},w=async function(e){try{p.renderSpinner(),await i(e,a.lists),p.render(a.movieTopRated,a.bookmarksID)}catch(e){console.log(e)}},E=async function(){try{u.renderSpinner();const e=await o();u.render(e,a.topRated_slide_index,a.slides_per_page)}catch(e){console.log(e)}},S=function(){u.render(a.topRated,a.topRated_slide_index,a.slides_per_page)},L=function(e){let t=a.topRated.length;a.topRated_slide_index+=e,a.topRated_slide_index===t+1?a.topRated_slide_index=1:0===a.topRated_slide_index&&(a.topRated_slide_index=t),u.render(a.topRated,a.topRated_slide_index,a.slides_per_page)},x=async function(e){try{p.renderSpinner(),await i(e,a.topRated),p.render(a.movieTopRated,a.bookmarksID)}catch(e){console.log(e)}},R=function(){g.render(a.bookmarks)},H=async function(e){try{p.renderSpinner(),await i(e,a.bookmarks),p.render(a.movieTopRated,a.bookmarksID),g.hideBookmarks()}catch(e){console.log(e)}},T=function(e){const t=a.movieTopRated;let n=a.bookmarksID;var r;t.id!=e||n.includes(t.id)?t.id==e&&n.includes(t.id)&&function(e,t){const n=a.bookmarks.findIndex((t=>t.id===e));a.bookmarksID.splice(n,1),a.bookmarks.splice(n,1),t.bookmarked=!1,l()}(t.id,t):(r=t,d(),a.bookmarks.push(r),a.bookmarksID.push(r.id),r.bookmarked=!0,l()),g.render(a.bookmarks),a.bookmarksID.some((function(e){return e===a.movieTopRated.id}))?document.querySelector(".btn--bookmark").innerHTML="Remove bookmark":document.querySelector(".btn--bookmark").innerHTML="Add to bookmark"},$=function(e,t){a.movieTopRated.myRate=t;const n=a.bookmarksID.findIndex((t=>t==e));-1!=n&&(a.bookmarks[n].myRate=t),document.querySelector(".rate").insertAdjacentHTML("afterbegin",t)};g.addHandlerBookmarksLoad(R),m.addHandlerSearch(k),h.addHandlerClick(f),p.addHandlerRender(b),p.addHandlerPopup(),p.addHandlerRate($),c.addHandlerQuery(_),v.listsRender(y),v.addHandlerSlider(M),v.addHandlerSingleMovie(w),c.addHandlerQuery(S),u.listsRender(E),u.addHandlerSlider(L),u.addHandlerSingleMovie(x),g.addHandlerBookmarkSingl(H),g.addHandlerBookmarks(T),g.toggleBookmarks()})();
//# sourceMappingURL=index.bundle.js.map
(()=>{"use strict";const e="https://image.tmdb.org/t/p/w500/",t=function(e){return`https://api.themoviedb.org/3${e}?api_key=90e6cdedb1af5c0bd8f14b69484e25e1`},n=async function(e){try{const n=await Promise.race([fetch(e),(t=10,new Promise((function(e,n){setTimeout((function(){n(new Error(`Request took too long! Timeout after ${t} second`))}),1e3*t)})))]);return await n.json()}catch(e){throw e}var t},r={movie:{},movieTopRated:{},search:{query:"",results:[],page:1,resultsPerPage:5},slides_per_page:6,lists:[],slide_index:1,topRated:[],topRated_slide_index:1,bookmarks:[],bookmarksID:[],rate:""},a=function(e=r.search.page){r.search.page=e;const t=(e-1)*r.search.resultsPerPage,n=e*r.search.resultsPerPage;return r.search.results.slice(t,n)},i=async function(e,a){try{const i=t(`/movie/${e}/videos`),s=await n(i),o=a.find((t=>t.id==e));r.movieTopRated=function(e,t){const n=e.results[0];return{id:t.id,title:t.title,language:t.language,releaseDate:t.releaseDate,posterPath:t.posterPath,overview:t.overview,popularity:t.popularity,voteAverage:t.voteAverage,key:null!=n?n.key:"",bookmarked:t.bookmarked,myRate:t.myRate?t.myRate:"N/A"}}(s,o);const l=r.bookmarksID.findIndex((t=>t==e));-1!=l&&null!=r.bookmarks[l].myRate?r.movieTopRated.myRate=r.bookmarks[l].myRate:r.movieTopRated.myRate=""}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥`),e}},s=async function(){try{const e=t("/movie/now_playing");return function(e){r.lists=e.results.map((e=>({id:e.id,title:e.title,language:e.original_language,releaseDate:e.release_date,posterPath:e.poster_path,overview:e.overview,popularity:e.popularity,voteAverage:e.vote_average,bookmarked:""})))}(await n(e)),r.lists}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥`),e}},o=async function(){try{const e=t("/movie/top_rated");!function(e){r.topRated=e.results.map((e=>({id:e.id,title:e.title,language:e.original_language,releaseDate:e.release_date,posterPath:e.poster_path,overview:e.overview,popularity:e.popularity,voteAverage:e.vote_average,bookmarked:""})))}(await n(e));return r.topRated}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥`),e}},l=function(){localStorage.setItem("bookmarks",JSON.stringify(r.bookmarks)),localStorage.setItem("bookmarksID",JSON.stringify(r.bookmarksID))};!function(){const e=localStorage.getItem("bookmarks"),t=localStorage.getItem("bookmarksID");e&&(r.bookmarks=JSON.parse(e),r.bookmarksID=JSON.parse(t))}();const d=function(){localStorage.clear("bookmarks"),localStorage.clear("bookmarksID")};const c=new class{addHandlerQuery(e){const t=[window.matchMedia("(min-width: 1200px)"),window.matchMedia("(min-width: 981px) and (max-width: 1200px)"),window.matchMedia("(min-width: 769px) and (max-width: 980px)"),window.matchMedia("(min-width: 541px) and (max-width: 768px)"),window.matchMedia("(min-width: 501px) and (max-width: 540px)"),window.matchMedia("(min-width: 320px) and (max-width: 500px)")];for(let n=0;n<t.length;n++)t[n].addEventListener("change",function(){this.controlQuery(t),e()}.bind(this),!1);this.controlQuery(t)}controlQuery(e){e[0].matches&&(r.slides_per_page=6,r.search.resultsPerPage=5),e[1].matches&&(r.slides_per_page=5,r.search.resultsPerPage=4),e[2].matches&&(r.slides_per_page=4,r.search.resultsPerPage=3),e[3].matches&&(r.slides_per_page=3,r.search.resultsPerPage=2),e[4].matches&&(r.slides_per_page=2,r.search.resultsPerPage=2),e[5].matches&&(r.slides_per_page=1,r.search.resultsPerPage=1)}};const p=new class{constructor(){this.singleMovie=document.querySelector("#movie"),this.parentElement=document.querySelector(".results"),this.parentElementMovie=document.querySelector(".details-box"),this.popupRating=document.querySelector(".popUp-rating"),this.ratingForm=document.getElementById("ratingForm"),this.checkBox=document.querySelectorAll(".rateCheckbox"),this.checkBtn=document.querySelector(".checkBtn"),this.voteContainer=document.querySelector(".vote-container")}addHandlerRender(e){const t=this.singleMovie;this.parentElement.addEventListener("click",(function(n){const r=n.target.closest(".btn");if(!r)return;const a=r.dataset.movieId;t.scrollIntoView({behavior:"smooth",block:"start"}),e(a)}))}addHandlerPopup(){const e=this.popupRating;this.parentElementMovie.addEventListener("click",(function(t){t.target.closest(".rate-icon")&&e.classList.add("visible-rating")})),this.popupRating.addEventListener("click",(function(t){t.target.closest(".close-form")&&e.classList.remove("visible-rating")}))}addHandlerRate(e){let t=this.checkBox;const n=this.parentElementMovie,r=this.popupRating;this.ratingForm.addEventListener("submit",(function(a){a.preventDefault();let i=null;document.querySelector(".rate").innerHTML="";for(let a=0;a<t.length;a++){if(t[a].checked){i=t[a].value;const s=n.firstElementChild.dataset.videoId;return console.log("chceker je "+i,t[a]),e(s,i),r.classList.remove("visible-rating"),!1}t[a].checked=!1}return!1}))}renderSpinner(){this.clear(),this.parentElementMovie.insertAdjacentHTML("afterbegin",'\n       <div class="spinner">\n         <i class="fas fa-spinner fa-spin"></i>\n        </div> \n  ')}render(e,t){this.clear();const n=this.generateMarkup(e,t);document.getElementById("movie").classList.add("movie-describe"),this.parentElementMovie.insertAdjacentHTML("afterbegin",n)}clear(){this.parentElementMovie.innerHTML=""}generateMarkup(t,n){return`<div class="movie-details" data-video-id = "${t.id}">\n              <div class="title-container">\n                 <h3><span>Movie title:</span> ${t.title}</h3>\n                  <div class="subtitle-description">\n                    <p><span>Language:</span>  ${t.language}</p>\n                    <p><span>Release date:</span>${t.releaseDate}</p>\n                  </div>\n                  \n              </div>\n              <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n              </div>\n              <div class="video-contianer">\n                ${""==t.key?'<div class="error">\n                        <div>\n                          <i class="fas fa-exclamation-triangle"></i>\n                        </div>\n                        <p>This movie doesn\'t have video</p>\n                       </div>':` <iframe\n                      src='https://www.youtube.com/embed/${t.key}'\n                  allowfullscreen=''\n                ></iframe>`}\n              </div>\n              <div class="video-description">\n              \n                <div class="overview-container">\n                   <p><span>Movie overview:</span> ${t.overview}</p>\n                 </div>\n                 <div class="popularity-container">\n                   <p><span>Movie popularity:</span> ${t.popularity}</p>\n                 </div>\n                 <div class="vote-container">\n                   <p><i class="fas fa-vote-yea"></i><span>Vote average:</span> ${t.voteAverage}</p>\n                  <p><i class="fas fa-vote-yea rate-icon"></i><span class= "my-rate">Your rate:</span><span class="rate">${null!=t.myRate?t.myRate:""} </span></p>                   \n                 </div>\n                 <div class="btn-container">\n                    <a href="#" class="btn details movie btn--bookmark" data-movie-id="${t.id}"\n                      > ${n.some((function(e){return e===t.id}))?"Remove bookmark":"Add to bookmark"}</a\n                    >\n                  </div>    \n               </div>\n\n             </div>\n           </div>`}};const m=new class{constructor(e){this.parentEl=document.querySelector(".search"),this.searchResult=document.querySelector(".search-results"),this.parentElement=document.querySelector(".results"),this.errorMessage=document.getElementById("message-error"),this.data=e,this.parentElementMovie=document.querySelector(".details-box"),this.pagination=document.querySelector(".pagination")}addHandlerSearch(e){this.parentEl.addEventListener("submit",(function(t){t.preventDefault(),e()}))}getQuery(){const e=this.parentEl.querySelector(".search__field").value;return this.clearInput(),e}clearInput(){this.parentEl.querySelector(".search__field").value=""}renderSpinner(){this.clear(),this.clearPagination(),this.parentElement.insertAdjacentHTML("afterbegin",'\n       <div class="spinner">\n         <i class="fas fa-spinner fa-spin"></i>\n        </div> \n  ')}render(e){if(!e||Array.isArray(e)&&0===e.length)return this.renderError();this.data=e,document.getElementById("movie").classList.remove("movie-describe"),this.parentElementMovie.innerHTML="";const t=this.generateMarkup();this.clear(),this.clearMessage(),this.parentElement.insertAdjacentHTML("beforeend",t)}clear(){this.parentElement.innerHTML=""}clearLoader(){this.searchResult.innerHTML=""}clearPagination(){this.pagination.innerHTML=""}generateMarkup(){return this.data.map((t=>{if(t.posterPath)return`<li class="single-movie">\n          <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n          </div>\n          <div class="movie-details">\n            <div class="title-container">\n              <h3>Title: ${t.title}</h3>\n            </div>\n            <div class="release-date">\n              <p>Vote average: ${t.voteAverage}</p>\n            </div>            \n            <div class="btn-container"><a href="#${t.id}" class="btn details"  data-movie-id="${t.id}">More details</a></div>\n          </div>\n        </li> `})).join("")}clearMessage(){this.errorMessage.innerHTML=""}renderError(){this.clearMessage(),this.clear(),this.errorMessage.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>NO MOVIES FOUND FOR YOUR QUERY! PLEASE TRY AGAIN</p>\n      </div>')}renderMessage(){this.clearMessage(),this.clear(),this.errorMessage.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is a field that the user must fill in</p>\n      </div>')}};const v=new class{constructor(){this.singleMovie=document.querySelector("#movie"),this.parentElement=document.querySelector(".latest-movie__list"),this.sliderNav=document.querySelector(".slider-nav"),this.sliderNext=document.querySelector(".slider-nav.next"),this.sliderPrevious=document.querySelector(".slider-nav.prev"),this.parentElementMovie=document.querySelector(".details-box")}listsRender(e){window.addEventListener("load",e)}renderSpinner(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n       <div class="spinner">\n         <i class="fas fa-spinner fa-spin"></i>\n        </div> \n  ')}render(e,t,n){if(this.clear(),!e||Array.isArray(e)&&0===e.length)return this.renderError();let r=[],a=t-1;for(let t=a;t<n+a&&t<e.length;t++){let n=this.generateMarkup(e[t]);r.push(n)}const i=r.join("");this.parentElement.insertAdjacentHTML("beforeend",i)}clear(){this.parentElement.innerHTML=""}addHandlerSlider(e){this.sliderNext.addEventListener("click",(function(t){t.target.closest(".fa-arrow-circle-right")&&e(1)})),this.sliderPrevious.addEventListener("click",(function(t){t.target.closest(".fa-arrow-circle-left")&&e(-1)}))}addHandlerSingleMovie(e){const t=this.singleMovie;this.parentElement.addEventListener("click",(function(n){const r=n.target.closest(".btn");if(!r)return;const a=r.dataset.movieId;t.scrollIntoView({behavior:"smooth",block:"start"}),e(a)}))}generateMarkup(t){return`<li class="single-movie slider-list">\n          <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n          </div>\n          <div class="movie-details">\n            <div class="title-container">\n              <h3>Title: ${t.title}</h3>\n            </div>\n            <div class="release-date">\n              <p>Vote average: ${t.voteAverage}</p>\n            </div>            \n            <div class="btn-container"><a href="#${t.id}" class="btn details"  data-movie-id="${t.id}">More details</a></div>\n          </div>\n        </li> `}renderError(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is some error. please try again</p>\n      </div>')}};const u=new class{constructor(){this.singleMovie=document.querySelector("#movie"),this.parentElement=document.querySelector(".top-rated-movies__list"),this.sliderNav=document.querySelector(".slider-nav"),this.sliderNext=document.querySelector(".top-rated-nav.next"),this.sliderPrevious=document.querySelector(".top-rated-nav.prev"),this.parentElementMovie=document.querySelector(".details-box"),this.parentElementBookmarks=document.querySelector(".bookmarks__list")}listsRender(e){window.addEventListener("load",e)}renderSpinner(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n       <div class="spinner">\n         <i class="fas fa-spinner fa-spin"></i>\n        </div> \n  ')}render(e,t,n){if(this.clear(),!e||Array.isArray(e)&&0===e.length)return this.renderError();let r=[],a=t-1;for(let t=a;t<n+a&&t<e.length;t++){let n=this.generateMarkup(e[t]);r.push(n)}const i=r.join("");this.parentElement.insertAdjacentHTML("beforeend",i)}clear(){this.parentElement.innerHTML=""}addHandlerSlider(e){this.sliderNext.addEventListener("click",(function(t){t.target.closest(".fa-arrow-circle-right")&&e(1)})),this.sliderPrevious.addEventListener("click",(function(t){t.target.closest(".fa-arrow-circle-left")&&e(-1)}))}addHandlerSingleMovie(e){const t=this.singleMovie;this.parentElement.addEventListener("click",(function(n){const r=n.target.closest(".btn");if(!r)return;const a=r.dataset.movieId;t.scrollIntoView({behavior:"smooth",block:"start"}),e(a)}))}generateMarkup(t){return`<li class="single-movie slider-list">\n          <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n          </div>\n          <div class="movie-details">\n            <div class="title-container">\n              <h3>Title: ${t.title}</h3>\n            </div>\n            <div class="release-date">\n              <p>Vote average: ${t.voteAverage}</p>\n            </div>            \n            <div class="btn-container"><a href="#${t.id}" class="btn details"  data-movie-id="${t.id}">More details</a></div>\n          </div>\n        </li> `}renderError(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is some error. please try again</p>\n      </div>')}};const h=new class{constructor(){this.parentElement=document.querySelector(".pagination")}addHandlerClick(e){this.parentElement.addEventListener("click",(function(t){const n=t.target.closest(".btn--inline");if(!n)return;const r=+n.dataset.goto;e(r)}))}render(e){if(this.clear(),!e||Array.isArray(e)&&0===e.length)return this.renderError();const t=this.generateMarkup(e);this.parentElement.insertAdjacentHTML("beforeend",t)}generateMarkup(e){const t=e.page,n=Math.ceil(e.results.length/e.resultsPerPage);return 1===t&&n>1?`\n      \n        <button data-goto="${t+1}" class="btn--inline pagination__btn--next">\n            <span>Page ${t+1}</span>\n                      <i class="fas fa-angle-right"></i>      \n\n          </button> \n      `:t===n&&n>1?`<button data-goto="${t-1}" class="btn--inline pagination__btn--prev">\n                       <i class="fas fa-angle-left"></i> \n\n            <span>Page ${t-1}</span>\n          </button>\n        `:t<n?`<button data-goto="${t-1}" class="btn--inline pagination__btn--prev">\n            <i class="fas fa-angle-left"></i> \n            <span>Page ${t-1}</span>\n          </button>\n          <button data-goto="${t+1}" class="btn--inline pagination__btn--next">\n            <span>Page ${t+1}</span>\n           <i class="fas fa-angle-right"></i>      \n          </button> \n        `:""}renderError(){this.clear(),this.parentElement.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is some error. please try again</p>\n      </div>')}clear(){this.parentElement.innerHTML=""}};const g=new class{constructor(){this.nav=document.querySelector(".nav"),this.bookmarks=document.querySelector(".bookmarks"),this.parentElement=document.querySelector(".bookmarks__list"),this.parentElementMovie=document.querySelector(".details-box"),this.bookmarksBtn=document.querySelector(".nav__btn--bookmarks")}addHandlerBookmarksLoad(e){window.addEventListener("load",e)}addHandlerBookmarkSingl(e){this.parentElement.addEventListener("click",(function(t){const n=t.target.closest(".single-movie");if(!n)return;const r=n.dataset.movieId;e(r)}))}addHandlerBookmarks(e){this.parentElementMovie.addEventListener("click",(function(t){t.preventDefault();const n=t.target.closest(".btn");if(!n)return;const r=n.dataset.movieId;return e(r),!1}))}render(e){if(this.clear(),!e||Array.isArray(e)&&0===e.length)return this.renderError();const t=this.generateMarkup(e);this.parentElement.insertAdjacentHTML("afterbegin",t)}clear(){this.parentElement.innerHTML=""}generateMarkup(t){return t.map((t=>`<li class="single-movie slider-list" data-movie-id="${t.id}">\n          <div class="image-container"><img src="${e+t.posterPath}" alt="${t.title}" >\n          </div>\n          <div class="movie-details">\n            <div class="title-container">\n              <h2>Title: ${t.title}</h2>\n            </div>\n            <div class="release-date">\n              <p>Vote average: ${t.voteAverage}</p>\n            </div>            \n          \n          </div>\n        </li> `)).join("")}renderError(){this.parentElement.insertAdjacentHTML("afterbegin",'\n      <div class="error">\n        <div>\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <p>There is some error. please try again</p>\n      </div>')}toggleBookmarks(){const e=this.bookmarks;this.nav.addEventListener("click",(function(t){const n=t.target.closest(".nav__btn--bookmarks");n&&(e.classList.toggle("show-bookmarks"),n.classList.toggle("show-bookmarks"))}))}hideBookmarks(){const e=this.bookmarks,t=this.bookmarksBtn;e.classList.remove("show-bookmarks"),t.classList.remove("show-bookmarks")}},k=async function(){try{const e=m.getQuery();if(!e)return;m.renderSpinner(),await async function(e){try{r.search.query=e;const a=t("/search/movie")+"&query="+e,i=(await n(a)).results;r.search.results=i.map((e=>({id:e.id,title:e.title,language:e.original_language,releaseDate:e.release_date,posterPath:e.poster_path,overview:e.overview,popularity:e.popularity,voteAverage:e.vote_average,bookmarked:"",myRate:""}))),r.search.page=1}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥`),e}}(e),m.render(a()),h.render(r.search)}catch(e){console.log(e)}},f=function(e){m.render(a(e)),h.render(r.search)},b=async function(e){try{p.renderSpinner(),await i(e,r.search.results),p.render(r.movieTopRated,r.bookmarksID)}catch(e){console.log(e)}},y=async function(){try{v.renderSpinner();const e=await s();v.render(e,r.slide_index,r.slides_per_page)}catch(e){console.log(e)}},_=function(e){v.render(r.lists,r.slide_index,r.slides_per_page)},M=function(e){let t=r.lists.length;r.slide_index+=e,r.slide_index===t+1?r.slide_index=1:0===r.slide_index&&(r.slide_index=t),v.render(r.lists,r.slide_index,r.slides_per_page)},w=async function(e){try{p.renderSpinner(),await i(e,r.lists),p.render(r.movieTopRated,r.bookmarksID)}catch(e){console.log(e)}},E=async function(){try{u.renderSpinner();const e=await o();u.render(e,r.topRated_slide_index,r.slides_per_page)}catch(e){console.log(e)}},S=function(){u.render(r.topRated,r.topRated_slide_index,r.slides_per_page)},L=function(e){let t=r.topRated.length;r.topRated_slide_index+=e,r.topRated_slide_index===t+1?r.topRated_slide_index=1:0===r.topRated_slide_index&&(r.topRated_slide_index=t),u.render(r.topRated,r.topRated_slide_index,r.slides_per_page)},R=async function(e){try{p.renderSpinner(),await i(e,r.topRated),p.render(r.movieTopRated,r.bookmarksID)}catch(e){console.log(e)}},x=function(){g.render(r.bookmarks)},H=async function(e){try{p.renderSpinner(),await i(e,r.bookmarks),p.render(r.movieTopRated,r.bookmarksID),g.hideBookmarks()}catch(e){console.log(e)}},T=function(e){const t=r.movieTopRated;let n=r.bookmarksID;var a;t.id!=e||n.includes(t.id)?t.id==e&&n.includes(t.id)&&function(e,t){const n=r.bookmarks.findIndex((t=>t.id===e));r.bookmarksID.splice(n,1),r.bookmarks.splice(n,1),t.bookmarked=!1,l()}(t.id,t):(a=t,d(),r.bookmarks.push(a),r.bookmarksID.push(a.id),a.bookmarked=!0,l()),g.render(r.bookmarks),r.bookmarksID.some((function(e){return e===r.movieTopRated.id}))?document.querySelector(".btn--bookmark").innerHTML="Remove bookmark":document.querySelector(".btn--bookmark").innerHTML="Add to bookmark"},$=function(e,t){r.movieTopRated.myRate=t;const n=r.bookmarksID.findIndex((t=>t==e));-1!=n&&(r.bookmarks[n].myRate=t),document.querySelector(".rate").insertAdjacentHTML("afterbegin",t)};g.addHandlerBookmarksLoad(x),m.addHandlerSearch(k),h.addHandlerClick(f),p.addHandlerRender(b),p.addHandlerPopup(),p.addHandlerRate($),c.addHandlerQuery(_),v.listsRender(y),v.addHandlerSlider(M),v.addHandlerSingleMovie(w),c.addHandlerQuery(S),u.listsRender(E),u.addHandlerSlider(L),u.addHandlerSingleMovie(R),g.addHandlerBookmarkSingl(H),g.addHandlerBookmarks(T),g.toggleBookmarks()})();
//# sourceMappingURL=index.bundle.js.map